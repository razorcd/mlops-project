version: '3.3'
services:
    # docker run --rm --name mlflow5 -v /tmp/mlopsdb:/tmp/mlopsdb -v /tmp/mlopsartifacts:/tmp/mlopsartifacts -p 5051:5050 mlflow_4
    mlflow_server:
        restart: always
        build:
          context: .
          dockerfile: Dockerfile-mlflow
          # args:
          #   buildno: 1
        image: mlflow_server
        container_name: mlflow_server
        ports:
            - 5051:5050
        networks:
            - frontend
            - backend
        # create these folders locally:
        volumes:
          - /tmp/mlopsdb:/tmp/mlopsdb
          - /tmp/mlopsartifacts:/tmp/mlopsartifacts

    # nginx:
    #     restart: always
    #     build: ./nginx
    #     image: mlflow_nginx
    #     container_name: mlflow_nginx
    #     ports:
    #         - "80:80"
    #     networks:
    #         - frontend
    #     depends_on:
    #         - web

networks:
    frontend:
        driver: bridge
    backend:
        driver: bridge

volumes:
    dbdata: